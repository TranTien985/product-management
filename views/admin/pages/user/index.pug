extends ../../layouts/default.pug
include ../../mixins/show-alert.pug
include ../../mixins/filter-status.pug
include ../../mixins/search-text.pug
include ../../mixins/pagination.pug
include ../../mixins/form-change-multi.pug

block main
  h1(class="mb-4") Quản lý người dùng

  +alert-error(5000)

  .card.mb-3 
    .card-header Tìm kiếm 
    .card-body 
      .row
        .col-6
          +search-text-order(keyword)

  .card.mb-3
    .card-header Danh sách đánh giá
    .card-body
      .row 
        .col-8 
          +change-status-user(`${prefixAdmin}/user/change-multi?_method=PATCH`)
        .col-4.text-right  
          +reviews-filter-status(filterStatus)

  .card.mb-3
    .card-header Danh sách
    .card-body
      table(
        class="table table-hover align-middle"
        reviews-checkbox-multi
      )
        thead
          tr
            th 
              input(type="checkbox" name="checkall")
            th STT
            th Họ tên
            th Email
            th Số điện thoại
            th Thời gian tạo
            th Trạng thái
            th Hành động

        tbody
          each item, index in users
            tr
              td 
                input(
                  type="checkbox"
                  name="id"
                  value=item.id 
                )
              //- Tính STT theo phân trang
              td #{pagination.limitItems * (pagination.currentPage - 1) + (index + 1)}

              td <b>#{item.fullName}</b>
              td #{item.email}
              td #{item.phone}
              td #{item.createdAt.toLocaleString()}

              td
                if(item.status == "active")
                  a(
                    href="javascript:;"
                    data-status="active"
                    data-id=item.id
                    button-change-status
                    class="badge badge-success"
                  ) Hoạt động
                else
                  a(
                    href="javascript:;"
                    data-status="inactive"
                    data-id=item.id
                    button-change-status
                    class="badge badge-danger"
                  ) Dừng hoạt động

              td
                button(
                  class="btn btn-danger btn-sm"
                  button-delete
                  data-id=item.id
                ) Xóa

  +pagination(pagination)

  form(
    action=""
    method="POST"
    id="form-change-status"
    data-path=`${prefixAdmin}/user/change-status`
  )

  form(
    action=""
    method="POST"
    id="form-delete-item"
    data-path=`${prefixAdmin}/user/delete`
  )

  //- Nhúng file JS xử lý sự kiện click
  script(src="/admin/js/reviews.js")